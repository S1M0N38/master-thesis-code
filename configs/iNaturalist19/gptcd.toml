epochs = 200
validate = 1
log = 8
path = "/data/bertolotto/experiments/iNaturalist19/"
num_gpus = 1

[patience]
accuracy-top-1 = 15

[model]
class = "EfficientNetB0"
num_classes = 768
dropout = 0.2
weights = "IMAGENET1K_V1"
l2_norm = true

[loss]
class = "CosineDistanceLoss"

[optimizer]
class = "Adam"
lr = 1e-3
weight_decay = 0
amsgrad = true

[lr_scheduler]
class = "CosineAnnealingLR"
T_max = 200
eta_min = 1e-4

[dataloaders.train]
class = "INaturalist19TrainDataLoader"
path = "/data/bertolotto/datasets/iNaturalist19"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
batch_size = 64
num_workers = 4

[dataloaders.val]
class = "INaturalist19ValDataLoader"
path = "/data/bertolotto/datasets/iNaturalist19"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
batch_size = 64
num_workers = 4

[dataloaders.test]
class = "INaturalist19TestDataLoader"
path = "/data/bertolotto/datasets/iNaturalist19"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
batch_size = 64
num_workers = 4

[metrics.train.accuracy-top-1]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 1

[metrics.train.accuracy-top-5]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 5

[metrics.val.accuracy-top-1]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 1

[metrics.val.accuracy-top-5]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 5

[metrics.test.accuracy-top-1]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 1

[metrics.test.accuracy-top-5]
class = "AlignmentAccuracy"
path_embeddings = "/data/bertolotto/datasets/iNaturalist19/embeddings/class_descriptions-gpt_sentence_transformer.npy"
top_k = 5
